USE DATABASE MANISH;
USE WAREHOUSE INEURONE;
CREATE OR REPLACE TABLE LIVE_ASSIGMENT
(
 order_id VARCHAR(20) PRIMARY KEY,
 order_date DATE,
 ship_date DATE,
 ship_mode VARCHAR(50),
 customer_name VARCHAR(50),
 segment VARCHAR(20),
 state VARCHAR(50),
 country VARCHAR(50),
 market VARCHAR(15),
 region VARCHAR(20),
 product_id VARCHAR(80),
 category VARCHAR(50),
 sub_category VARCHAR(35),
 product_name VARCHAR(200),
 sales NUMBER(10,3),
 quantity NUMBER (10,5),
 discount NUMBER (5,5),
 profit FLOAT,
 shipping_cost FLOAT,
 order_priority VARCHAR(10),
 year DATE
 );
  
 DESCRIBE TABLE LIVE_ASSIGMENT;
  SELECT* FROM LIVE_ASSIGMENT;

CREATE OR REPLACE TABLE LIVE_ASSIGMENT_COPY AS
SELECT* FROM LIVE_ASSIGMENT;

ALTER TABLE  LIVE_ASSIGMENT_COPY
ADD PRIMARY KEY(ORDER_ID);

DESCRIBE TABLE  LIVE_ASSIGMENT_COPY;
 SELECT* FROM LIVE_ASSIGMENT_COPY;
 
ALTER TABLE LIVE_ASSIGMENT_COPY
DROP PRIMARY KEY;

ALTER TABLE LIVE_ASSIGMENT_COPY ALTER order_date SET DATA TYPE DATE;


------. EXTACT THE LAST NUMBER AFTER THE - AND CREATE OTHER COLUMN AND UPDATE IT.(- ke number ko nikal k column banao)


select substr(ORDER_ID, 9, 6) from  LIVE_ASSIGMENT_COPY AS NEW_ORDER_ID;

-----EXTACT THE LAST NUMBER AFTER THE - AND CREATE OTHER COLUMN AND UPDATE IT


create or replace view update_order_id   as
    select ORDER_ID, ORDER_DATE, SHIP_DATE, COUNTRY,
       substr(ORDER_ID, 9, 6)AS NEW_ODRDER
    from  LIVE_ASSIGMENT_COPY;
    
    select * from update_order_id;
    
    
   
    select substring('manish singh',8,10) AS string_practice; 
    
    ---FLAG ,IF DISCOUNT IS GREATER THEN 0 THEN  YES ELSE FALSE AND PUT IT IN NEW COLUMN FRO EVERY ORDER ID.
    
    SELECT*,   
       CASE 
       WHEN DISCOUNT >0 THEN 'YES'
       ELSE  'FALSE'
       END AS  NEW_DISCOUNT
       FROM    LIVE_ASSIGMENT_COPY;
   
  
   ------FIND OUT HOW MUCH DAYS TAKEN FOR EACH ORDER TO PROCESS FOR THE SHIPMENT FOR EVERY ORDER ID;
   
   
 SELECT DATEDIFF('DAY',ORDER_DATE,SHIP_DATE) FROM LIVE_ASSIGMENT_COPY AS NO_OF_DAYS_SHIPMENT;

create or replace view NO_OF_SHIPMENT_DAYS   as
    select ORDER_ID, ORDER_DATE, SHIP_DATE, COUNTRY,
      DATEDIFF('DAY',ORDER_DATE,SHIP_DATE) AS NO_OF_DAYS_SHIPMENT 
    from  LIVE_ASSIGMENT_COPY;

SELECT* FROM NO_OF_SHIPMENT_DAYS;

----. FLAG THE PROCESS DAY AS BY RATING IF IT TAKES LESS OR EQUAL 3  DAYS MAKE 5,LESS OR EQUAL THAN 6 DAYS BUT MORE
----THAN 3 MAKE 4,LESS THAN 10 BUT MORE THAN 6 MAKE 3,MORE THAN 10 MAKE IT 2 FOR EVERY ORDER ID.

 
SELECT*,
   CASE
   WHEN NO_OF_DAYS_SHIPMENT <= 3 THEN 5
   WHEN NO_OF_DAYS_SHIPMENT <= 6 AND NO_OF_DAYS_SHIPMENT >3 THEN 4
    WHEN NO_OF_DAYS_SHIPMENT <=10 AND NO_OF_DAYS_SHIPMENT >6 THEN 3
    WHEN NO_OF_DAYS_SHIPMENT >10 THEN 2
    ELSE 0
    END AS RATING
    FROM NO_OF_SHIPMENT_DAYS;
    
    
    




  






    